## 单例模式的基本实现

参考四种实现方式：<https://www.cnblogs.com/yxi-liu/p/singleton.html> 

```python
class SingletonType(type):
    _instances = {}

    def __call__(cls, *args, **kwargs):
        if cls not in cls._instances:
            cls._instances[cls] = super(SingletonType, cls).__call__(*args, **kwargs)
        return cls._instances[cls]

def singleton(cls):
    instances = {}

    def _singleton(*args, **kwargs):
        if cls not in instances:
            instances[cls] = cls(*args, **kwargs)
        return instances[cls]

    return _singleton

class A(metaclass=SingletonType):
    pass

@singleton
class B:
    pass

class C:
    pass

if __name__ == '__main__':
    print(A() is A())
    print(B() is B())
    print(C() is C())
```



## 单例模式实现的日志

```python
import logging
import os
import time
import sys


class SingletonType(type):
    _instances = {}

    def __call__(cls, *args, **kwargs):
        if cls not in cls._instances:
            cls._instances[cls] = super(SingletonType, cls).__call__(*args, **kwargs)
        return cls._instances[cls]


class Logger(metaclass=SingletonType):
    def __init__(self, log_file=None):
        # 日志文件的路径
        if log_file is None:
            # 文件的当前目录
            current_path = os.path.dirname(os.path.realpath(__file__))
            current_time = time.strftime("%Y-%m-%d-%H%M%S", time.localtime())
            log_file = os.path.join(current_path, f'log_{current_time}.log')

        self.logger = logging.getLogger(__name__)
        formater = logging.Formatter('%(asctime)s %(name)s %(filename)s %(message)s')
        # 标准输出
        standard_out = logging.StreamHandler(sys.stdout)
        standard_out.setFormatter(formater)
        self.logger.addHandler(standard_out)    # 添加标准输出
        # 日志文件输出
        file_out = logging.FileHandler(log_file)
        file_out.setFormatter(formater)
        self.logger.addHandler(file_out)    # 添加文件输出
        self.logger.setLevel(logging.INFO)

    def debug(self, msg, *args, **kwargs):
        self.logger.debug(msg, *args, **kwargs)

    def info(self, msg, *args, **kwargs):
        self.logger.info(msg, *args, **kwargs)

    def warning(self, msg, *args, **kwargs):
        self.logger.warning(msg, *args, **kwargs)

    def error(self, msg, *args, **kwargs):
        self.logger.error(msg, *args, **kwargs)

    def critical(self, msg, *args, **kwargs):
        self.logger.critical(msg, *args, **kwargs)

    def log(self, level, msg, *args, **kwargs):
        self.logger.log(level, msg, *args, **kwargs)


if __name__ == '__main__':
    logger = Logger()
    logger.info("This is a info")

```



